# ───────────────────────────────────────────────────────────
# Hyprland — Autostart (Optimized)
# ───────────────────────────────────────────────────────────
# Philosophy:
# - Start only session‑critical services
# - Never block compositor startup
# - Fail loudly but safely
# ───────────────────────────────────────────────────────────


# -----------------------------------------------------------
# Cursor (must be early)
# -----------------------------------------------------------
# Avoid GTK/Qt cursor mismatch
exec-once = hyprctl setcursor Bibata-Modern-Ice 15


# -----------------------------------------------------------
# Environment sanity (Wayland-first)
# -----------------------------------------------------------
# Ensures toolkits behave correctly on Wayland
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=Hyprland


# -----------------------------------------------------------
# UI & Shell Components
# -----------------------------------------------------------
# Noctalia shell (bar / widgets)
exec-once = qs -c noctalia-shell || notify-send "Hyprland" "Noctalia shell failed"

# Vicinae background service
exec-once = vicinae server || notify-send "Hyprland" "Vicinae failed"


# -----------------------------------------------------------
# System Tray & Connectivity
# -----------------------------------------------------------
# NetworkManager tray (Wayland-safe)
exec-once = nm-applet --indicator || notify-send "Hyprland" "nm-applet failed"

# KDE Connect daemon
exec-once = kdeconnectd || notify-send "Hyprland" "kdeconnectd failed"


# -----------------------------------------------------------
# Authentication (MANDATORY)
# -----------------------------------------------------------
# Polkit agent for GUI privilege escalation
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 \
  || notify-send "Hyprland" "Polkit agent not running"


# -----------------------------------------------------------
# Optional Quality-of-Life (commented by default)
# -----------------------------------------------------------
# Clipboard manager
# exec-once = wl-paste --type text --watch cliphist store
# exec-once = wl-paste --type image --watch cliphist store

# Notification daemon (if not bundled in shell)
# exec-once = mako

# XDG portal (only if issues appear)
exec-once = /usr/lib/xdg-desktop-portal-hyprland
